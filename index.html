<!DOCTYPE html>
<html lang="es-cl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./progressbar.css">
    <title>XLSX TAV Duoc Alameda</title>
</head>
<body>
    <img src="https://lh3.googleusercontent.com/proxy/KEi2naubXbQ6_JjHd8P3FBGeP60BM1W8fn6HjxrRluZkQ6jagzGfvbXhXnIVW0nIvolg7XTVahYAoe1glR-dt__mIBawMY7S" alt="Glasses logo">
    <p>Open Dev Mode!</p>
    <div id="progressbar" class="meter animate">
        <span></span>
    </div>
    <p id="datos"></p>
    <script src="xlsx.full.min.js"></script>
    <script>
        let datos;
        //let url = 'http://inscripciones.duoc.cl/IA/oferta/2021/SAN-BERNARDO-OA-1Semestre2021.xlsx';
        let url = 'ALAMEDA.xlsx'
        fetch(url).then(res => { 
            return res.arrayBuffer();
        }).then(res => {
            var data = new Uint8Array(res);
            var arr = new Array();
            for(var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
            var bstr = arr.join("");
            var workbook = XLSX.read(bstr, {type:"binary"});
            var first_sheet_name = workbook.SheetNames[0];
            var worksheet = workbook.Sheets[first_sheet_name];
            datos = XLSX.utils.sheet_to_json(worksheet, {raw : true});
            document.getElementById("progressbar").style.display = "None"

            if (datos.length == 0){
                document.getElementById('datos').innerHTML = "NADA <br>"+url;
            }
            else {
                document.getElementById('datos').innerHTML = "Hay Datos <br>"+url;
            }
        }).catch(function (error) {
            console.log('Request failed', error);
          });
    </script>
</body>
</html>
